(function() {
  var $$, MiaLexer, MiaParser, assert, compiler, grammar, unit_, yy;

  assert = require('assert');

  ({unit_, grammar, yy, compiler, MiaLexer, MiaParser} = require('./common'));

  $$ = unit_(module);

  describe('MiaParser', function() {
    return describe('@parse', function() {
      return it('should work', function() {
        /*
        Parser
        */
        var ast, data, err, lexer, parser, terminals, tok;
        terminals = grammar.parser.terminals_;
        lexer = new MiaLexer();
        $$.h2('Data');
        data = "def (hello)\n\n  def (say $t)\n    | $t\n\n  say \"Hello World\"\n  say \"Goodbye World\"\n\nhello";
        $$._(data);
        $$.h2('Lex');
        lexer.setInput(data);
        while ((tok = lexer.lex()) !== lexer.EOF) {
          $$._(terminals[tok]);
        }
        parser = new MiaParser(lexer, yy);
        $$.h2('Parse');
        try {
          ast = parser.parse(data);
        } catch (error) {
          err = error;
          $$._(err.message);
          $$._(err.hash);
        }
        $$.h2('AST');
        return $$._(JSON.stringify(ast, null, 2));
      });
    });
  });

}).call(this);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWlhcGFyc2VyLmpzIiwic291cmNlcyI6WyJtaWFwYXJzZXIuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsTUFBQSxFQUFBLEVBQUEsUUFBQSxFQUFBLFNBQUEsRUFBQSxNQUFBLEVBQUEsUUFBQSxFQUFBLE9BQUEsRUFBQSxLQUFBLEVBQUE7O0VBQUEsTUFBQSxHQUFTLE9BQUEsQ0FBUSxRQUFSOztFQUNULENBQUEsQ0FBQyxLQUFELEVBQVEsT0FBUixFQUFpQixFQUFqQixFQUFxQixRQUFyQixFQUErQixRQUEvQixFQUF5QyxTQUF6QyxDQUFBLEdBQXNELE9BQUEsQ0FBUSxVQUFSLENBQXREOztFQUNBLEVBQUEsR0FBSyxLQUFBLENBQU0sTUFBTjs7RUFFTCxRQUFBLENBQVMsV0FBVCxFQUFzQixRQUFBLENBQUEsQ0FBQTtXQUNwQixRQUFBLENBQVMsUUFBVCxFQUFtQixRQUFBLENBQUEsQ0FBQTthQUNqQixFQUFBLENBQUcsYUFBSCxFQUFrQixRQUFBLENBQUEsQ0FBQSxFQUFBOzs7O0FBQ2hCLFlBQUEsR0FBQSxFQUFBLElBQUEsRUFBQSxHQUFBLEVBQUEsS0FBQSxFQUFBLE1BQUEsRUFBQSxTQUFBLEVBQUE7UUFBQSxTQUFBLEdBQVksT0FBTyxDQUFDLE1BQU0sQ0FBQztRQUMzQixLQUFBLEdBQVEsSUFBSSxRQUFKLENBQUE7UUFDUixFQUFFLENBQUMsRUFBSCxDQUFNLE1BQU47UUFDQSxJQUFBLEdBQ0E7UUFXQSxFQUFFLENBQUMsQ0FBSCxDQUFLLElBQUw7UUFDQSxFQUFFLENBQUMsRUFBSCxDQUFNLEtBQU47UUFDQSxLQUFLLENBQUMsUUFBTixDQUFlLElBQWY7QUFDQSxlQUFNLENBQUMsR0FBQSxHQUFNLEtBQUssQ0FBQyxHQUFOLENBQUEsQ0FBUCxDQUFBLEtBQXVCLEtBQUssQ0FBQyxHQUFuQztVQUNFLEVBQUUsQ0FBQyxDQUFILENBQUssU0FBVSxDQUFBLEdBQUEsQ0FBZjtRQURGO1FBS0EsTUFBQSxHQUFTLElBQUksU0FBSixDQUFjLEtBQWQsRUFBcUIsRUFBckI7UUFFVCxFQUFFLENBQUMsRUFBSCxDQUFNLE9BQU47QUFDQTtVQUNFLEdBQUEsR0FBTSxNQUFNLENBQUMsS0FBUCxDQUFhLElBQWIsRUFEUjtTQUFBLGFBQUE7VUFFTTtVQUNKLEVBQUUsQ0FBQyxDQUFILENBQUssR0FBRyxDQUFDLE9BQVQ7VUFDQSxFQUFFLENBQUMsQ0FBSCxDQUFLLEdBQUcsQ0FBQyxJQUFULEVBSkY7O1FBTUEsRUFBRSxDQUFDLEVBQUgsQ0FBTSxLQUFOO2VBQ0EsRUFBRSxDQUFDLENBQUgsQ0FBSyxJQUFJLENBQUMsU0FBTCxDQUFlLEdBQWYsRUFBb0IsSUFBcEIsRUFBMEIsQ0FBMUIsQ0FBTDtNQWxDZ0IsQ0FBbEI7SUFEaUIsQ0FBbkI7RUFEb0IsQ0FBdEI7QUFKQSIsInNvdXJjZXNDb250ZW50IjpbImFzc2VydCA9IHJlcXVpcmUgJ2Fzc2VydCdcbnt1bml0XywgZ3JhbW1hciwgeXksIGNvbXBpbGVyLCBNaWFMZXhlciwgTWlhUGFyc2VyfSA9IHJlcXVpcmUoJy4vY29tbW9uJylcbiQkID0gdW5pdF8gbW9kdWxlXG5cbmRlc2NyaWJlICdNaWFQYXJzZXInLCAtPlxuICBkZXNjcmliZSAnQHBhcnNlJywgLT5cbiAgICBpdCAnc2hvdWxkIHdvcmsnLCAtPlxuICAgICAgdGVybWluYWxzID0gZ3JhbW1hci5wYXJzZXIudGVybWluYWxzX1xuICAgICAgbGV4ZXIgPSBuZXcgTWlhTGV4ZXIoKVxuICAgICAgJCQuaDIoJ0RhdGEnKVxuICAgICAgZGF0YSA9XG4gICAgICBcIlwiXCJcbiAgICAgIGRlZiAoaGVsbG8pXG5cbiAgICAgICAgZGVmIChzYXkgJHQpXG4gICAgICAgICAgfCAkdFxuXG4gICAgICAgIHNheSBcIkhlbGxvIFdvcmxkXCJcbiAgICAgICAgc2F5IFwiR29vZGJ5ZSBXb3JsZFwiXG5cbiAgICAgIGhlbGxvXG4gICAgICBcIlwiXCJcbiAgICAgICQkLl8gZGF0YVxuICAgICAgJCQuaDIoJ0xleCcpXG4gICAgICBsZXhlci5zZXRJbnB1dChkYXRhKVxuICAgICAgd2hpbGUgKHRvayA9IGxleGVyLmxleCgpKSAhPSBsZXhlci5FT0ZcbiAgICAgICAgJCQuXyB0ZXJtaW5hbHNbdG9rXVxuICAgICAgIyMjXG4gICAgICBQYXJzZXJcbiAgICAgICMjI1xuICAgICAgcGFyc2VyID0gbmV3IE1pYVBhcnNlcihsZXhlciwgeXkpXG5cbiAgICAgICQkLmgyKCdQYXJzZScpXG4gICAgICB0cnlcbiAgICAgICAgYXN0ID0gcGFyc2VyLnBhcnNlKGRhdGEpXG4gICAgICBjYXRjaCBlcnJcbiAgICAgICAgJCQuXyBlcnIubWVzc2FnZVxuICAgICAgICAkJC5fIGVyci5oYXNoXG5cbiAgICAgICQkLmgyKCdBU1QnKVxuICAgICAgJCQuXyhKU09OLnN0cmluZ2lmeShhc3QsIG51bGwsIDIpKVxuIl19
